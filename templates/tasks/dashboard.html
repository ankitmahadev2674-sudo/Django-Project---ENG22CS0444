{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="mb-0">Your Tasks</h2>
  <a class="btn btn-primary" href="{% url 'tasks:create' %}">+ New Task</a>
</div>

<ul class="nav nav-pills mb-3">
  <li class="nav-item"><a class="nav-link {% if status == 'all' %}active{% endif %}" href="?status=all">All ({{ counts.all }})</a></li>
  <li class="nav-item"><a class="nav-link {% if status == 'open' %}active{% endif %}" href="?status=open">Open ({{ counts.open }})</a></li>
  <li class="nav-item"><a class="nav-link {% if status == 'done' %}active{% endif %}" href="?status=done">Done ({{ counts.done }})</a></li>
</ul>

<div class="table-responsive">
  <table class="table align-middle">
    <thead>
      <tr>
        <th>Title</th>
        <th class="d-none d-md-table-cell">Description</th>
        <th>Due</th>
        <th>Status</th>
        <th class="text-end">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for task in tasks %}
      <tr class="{% if task.completed %}table-success{% endif %}">
        <td><strong>{{ task.title }}</strong></td>
        <td class="d-none d-md-table-cell">{{ task.description|default:"" }}</td>
        <td>{{ task.due_date|date:"Y-m-d"|default:"" }}</td>
        <td>
          {% if task.completed %}
            <span class="badge text-bg-success">Completed</span>
          {% else %}
            <span class="badge text-bg-secondary">Open</span>
          {% endif %}
        </td>
        <td class="text-end">
          <a class="btn btn-sm btn-outline-secondary" href="{% url 'tasks:update' task.pk %}">Edit</a>
          <a class="btn btn-sm btn-outline-danger" href="{% url 'tasks:delete' task.pk %}">Delete</a>
          <a class="btn btn-sm btn-outline-primary" href="{% url 'tasks:toggle' task.pk %}">
            {% if task.completed %}Mark Incomplete{% else %}Mark Complete{% endif %}
          </a>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="5" class="text-center text-muted">No tasks yet. Create your first one!</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
